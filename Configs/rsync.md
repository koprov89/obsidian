---
tags:
  - rsync
  - linux
  - commands
  - backup
date: 2026-01-13
---

## Базовое использование

Всё как scp
```
scp username@server:/directory/file.file /home/user/
```

## Ключи

`-a`: сохранять всю структуру со всеми правами и прочее. Юзать всегда

`-z`: сжатие данных в процессе

`-v`: вывод информации

`--progress`: ну понятно

`--partial`: "говорит" `rsync` не удалять частично переданные файлы. В следующий раз он попытается докачать их с того места, где закончил.

`--partial-dir=DIR`: более продвинутый и безопасный аналог. `rsync` будет сохранять частичные файлы не в целевую директорию, а в указанную временную (`DIR`).

`--bwlimit=RATE`: ограничение скорости в KB/sec

`--delete`: удалять файлы которых нет в источнике

`-n`: dry-run. Симуляция

`--ignore-existing`:  игнорирование существующих файлов

`--update / -u`:  обновление только более старых файлов

`-e ssh`: указание ключей ssh, пример `rsync -avz -e 'ssh -i /path/to/private_key' /src/ user@host:/dest/` 

`--exclude`: исключение файлов или папок `rsync -avz --delete --exclude='cache/' --exclude='tmp/' --exclude='*.log' user@production-server:/var/www/ /local/mirror/`

`-H`: сохранять hardlinkи. Нужно для использования ключа `--link-dest`

`--link-dest=/path/to/previous/version`: чтобы если с предыдущего допустим бэкапа мало что поменялось и оно содержится в `/path/to/previous/version` не хранить копии одинаковых данных, создавая вместо этого хардлинки. Пример:
`rsync -avvH --link-dest=/home/aleksey/test/rsync_learn/test2 test1/ test3`
Здесь у нас есть исходная папка test1. Папка test2 содержить предыдущий бэкап test1. Если в test1 просто добавился новый файл, то фактически копироваться будет только он, а те что уже были (и соответственно их копии лежат в test2) - не будут копироваться, просто создастся новый хардлинк на них

`--usermap=www-data:webadmin`: переназначить права в процессе. Опция `-a` сохраняет те же права что были в исходнике, но на сервере может не быть такого пользователя, вместо этого мы хотим чтобы файлы принадлежали другому

## Related Notes
- [[sync via ssh bi-directional]]
- [[Commands/stow git]]